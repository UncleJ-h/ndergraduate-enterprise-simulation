# 作业2：HAPPO产业链协同建模

## 任务描述

把库存管理的HAPPO (Heterogeneous-Agent Proximal Policy Optimization) 算法改造成产业链企业协同决策系统。

## 给你的资源

1. **参考代码** (`reference-code.zip`)：多级库存管理的HAPPO实现
2. **参考论文** (`reference-paper.pdf`)：HAPPO算法理论
3. **产业链数据** (`supply-chain-data.json`)：30家企业的供应链网络

## 核心挑战

**原始场景**：多个仓库的库存协调优化  
**目标场景**：产业链上下游企业的协同决策

你需要思考：
- 仓库 → 企业
- 库存水平 → 生产能力/订单需求
- 补货策略 → 订单分配/产能规划  
- 协调机制 → 企业间合作策略

## 具体要求

### 1. 多智能体建模
- 将30家企业建模为智能体（Agent）
- 设计企业状态空间（生产能力、订单状况、库存等）
- 定义动作空间（生产决策、订单分配、价格策略等）

### 2. 协同机制设计
- 设计奖励函数：个体收益 + 协同收益
- 实现信息共享机制
- 建立上下游协调策略

### 3. HAPPO算法适配
- 理解异构智能体的策略更新
- 实现分布式训练机制
- 处理企业间的策略差异

## 提交内容

压缩包包含：
```
作业2提交/
├── main.py              # 主程序入口
├── happo_agent.py       # HAPPO智能体实现
├── supply_chain_env.py  # 产业链环境
├── coordination.py      # 协同机制
├── results/             # 结果文件夹
│   ├── training_curves.png
│   ├── coordination_analysis.json
│   └── network_visualization.html
└── README.md            # 简单说明
```

## 评分细节

- **基础实现 (60分)**：多智能体系统能运行
- **协同效果 (25分)**：展示企业间协作优于独立决策
- **算法正确 (15分)**：HAPPO实现符合原理
- **创新应用 (+15分)**：独特的协同机制设计

## 核心概念

### HAPPO关键点
1. **异构智能体**：每个企业有不同的策略网络
2. **近端策略优化**：稳定的策略更新
3. **分布式训练**：企业可独立更新策略
4. **全局协调**：通过奖励函数引导合作

### 产业链特征
1. **上下游依赖**：供应商-制造商-分销商关系
2. **信息不对称**：企业间信息共享程度
3. **利益博弈**：个体利益vs整体效益
4. **动态调整**：需求变化下的策略适应

## 提示问题

1. **算法理解**：
   - "HAPPO如何处理异构智能体？"
   - "近端策略优化的数学原理是什么？"

2. **场景映射**：
   - "库存管理和产业链协同的相似点？"
   - "如何设计企业的奖励函数？"

3. **技术实现**：
   - "如何用PyTorch实现策略网络？"
   - "分布式训练的同步机制？"

## 成功示例

一个成功的实现应该能展示：
- **收敛性**：训练曲线显示策略逐渐优化
- **协同性**：合作策略优于竞争策略
- **稳定性**：面对需求波动的鲁棒性
- **可解释性**：能解释企业决策逻辑

## 常见陷阱

❌ 把所有企业当成同质智能体  
❌ 奖励函数设计过于简单  
❌ 忽略上下游关系约束  
❌ 训练不稳定或不收敛

---

**截止时间：第7周周日 23:59**

多智能体很复杂，多问AI，慢慢调试。